<!doctype html>
<html lang="fi">
  <head>
    <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="gisfin - Avoimen suomalaisen paikkatiedon työkalupakki R-kielelle" />
<meta property="og:description" content="PÄIVITYS 2020-11-02: gisfin-paketin kehitystyö on lopetettu ja kehitystyö on siirtynyt geofi-paketin pariin. Tämä alun perin Louhos-blogissa julkaistu kirjoitus on arkistoitu rOpenGov-blogiin esimerkkinä aiempien vuosien kehitystyöstä. Alla esitetyt esimerkit eivät todennäköisesti enää toimi geofi-paketin uusilla versioilla.
Paikkatiedon käsittely on keskeinen osa avoimen datan analysointia ja visualisointia. Nykyisellään paikkatietoaineistot ovat hajallaan eri lähteissä, tiedostomuodoissa ja koordinaattijärjestelmissä, joten niiden hyödyntäminen vaatii huomattavaa erityisosaamista. Iso osa paikkatietoaineistojen käsittelyyn liittyvistä toimenpiteistä on kuitenkin automatisoitavissa. Tästä syystä olemme kehittäneet suomalaisen paikkatiedon käsittelyyn tarkoitetun R-paketin: gisfin." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/fi/2014/08/gisfin-avoimen-suomalaisen-paikkatiedon-ty%C3%B6kalupakki-r-kielelle/" />
<meta property="article:published_time" content="2014-08-24T00:00:00+00:00" />
<meta property="article:modified_time" content="2014-08-24T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="gisfin - Avoimen suomalaisen paikkatiedon työkalupakki R-kielelle"/>
<meta name="twitter:description" content="PÄIVITYS 2020-11-02: gisfin-paketin kehitystyö on lopetettu ja kehitystyö on siirtynyt geofi-paketin pariin. Tämä alun perin Louhos-blogissa julkaistu kirjoitus on arkistoitu rOpenGov-blogiin esimerkkinä aiempien vuosien kehitystyöstä. Alla esitetyt esimerkit eivät todennäköisesti enää toimi geofi-paketin uusilla versioilla.
Paikkatiedon käsittely on keskeinen osa avoimen datan analysointia ja visualisointia. Nykyisellään paikkatietoaineistot ovat hajallaan eri lähteissä, tiedostomuodoissa ja koordinaattijärjestelmissä, joten niiden hyödyntäminen vaatii huomattavaa erityisosaamista. Iso osa paikkatietoaineistojen käsittelyyn liittyvistä toimenpiteistä on kuitenkin automatisoitavissa. Tästä syystä olemme kehittäneet suomalaisen paikkatiedon käsittelyyn tarkoitetun R-paketin: gisfin."/>



    <link rel="canonical" href="/fi/2014/08/gisfin-avoimen-suomalaisen-paikkatiedon-ty%C3%B6kalupakki-r-kielelle/">

    <title>
      
        gisfin - Avoimen suomalaisen paikkatiedon työkalupakki R-kielelle | rOpenGov - R packages for open government data analytics
      
    </title>

    
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link href="/css/style.css" rel="stylesheet">

    

    

    

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin="anonymous" />

<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin="anonymous"></script>
<script src="https://www.kela.fi/kelafi-theme/js/tablesorter/jquery.tablesorter-2.0.5.min.js"></script>




  </head>
  <body>
    
      

<header class="blog-header">
    <nav class="navbar navbar-expand-md navbar-dark bg-dark">
        <a class="navbar-brand" href="/fi">
            <img src="/images/logo2020_white_orange.svg" height="30" class="d-inline-block align-top"
    alt="rOpenGov - R packages for open government data analytics">


        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"
            aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-between" id="navbarNav">
            <ul class="navbar-nav">
                
                
                <li class="nav-item ">
                    
                        <a class="nav-link" href="/fi">Etusivu</a>
                    
                </li>
                
                <li class="nav-item ">
                    
                        <a class="nav-link" href="/fi/post/">Blogi</a>
                    
                </li>
                
                <li class="nav-item ">
                    
                        <a class="nav-link" href="/fi/projects/">Projektit</a>
                    
                </li>
                
                <li class="nav-item ">
                    
                        <a class="nav-link" href="/fi/community/">Yhteisö</a>
                    
                </li>
                
            </ul>
            
            <ul class="navbar-nav">
                
                        
                            <a class="nav-link" href="/">English</a>
                        
                            <a class="nav-link" href="/fi/">Suomi</a>
                        
                    
            </ul>
            
        </div>
    </nav>
</header>

    

    
    <div class="container">
      <div class="row">
        <div class="col-12 col-lg-12 blog-main">

          

<header>
    <h2 class="blog-post-title">
    <a class="text-dark" href="/fi/2014/08/gisfin-avoimen-suomalaisen-paikkatiedon-ty%C3%B6kalupakki-r-kielelle/">gisfin - Avoimen suomalaisen paikkatiedon työkalupakki R-kielelle</a>
</h2>

 
    <hr>
</header>

<article class="blog-post">
    <p><em><strong>PÄIVITYS 2020-11-02: gisfin-paketin kehitystyö on lopetettu ja kehitystyö on siirtynyt <a href="https://github.com/rOpenGov/geofi">geofi-paketin</a> pariin. Tämä alun perin Louhos-blogissa julkaistu kirjoitus on arkistoitu rOpenGov-blogiin esimerkkinä aiempien vuosien kehitystyöstä. Alla esitetyt esimerkit eivät todennäköisesti enää toimi geofi-paketin uusilla versioilla.</strong></em></p>
<p><a href="https://fi.wikipedia.org/wiki/Paikkatieto">Paikkatiedon</a> käsittely on keskeinen osa avoimen datan analysointia ja visualisointia. Nykyisellään paikkatietoaineistot ovat hajallaan eri lähteissä, tiedostomuodoissa ja koordinaattijärjestelmissä, joten niiden hyödyntäminen vaatii huomattavaa erityisosaamista. Iso osa paikkatietoaineistojen käsittelyyn liittyvistä toimenpiteistä on kuitenkin automatisoitavissa. Tästä syystä olemme kehittäneet suomalaisen paikkatiedon käsittelyyn tarkoitetun R-paketin: <a href="https://github.com/rOpenGov/gisfin"><code>gisfin</code></a>. <a href="http://datademo.fi/">Datademo-rahoituksen</a> turvin olemme saaneet <code>gisfin</code>-paketin kehityksen vauhdikkaaseen alkuun.</p>
<p>Paketin kehitysversio löytyy <a href="https://github.com/rOpenGov/gisfin">githubista</a> ja vaikka kehitettävää on vielä paljon, voi pakettia jo hyödyntää monenlaisiin tehtäviin. Datalähteet, joita paketti hyödyntää, sekä lyhyet käyttöä kuvaavat esimerkit löytyvät paketin <a href="https://github.com/rOpenGov/helsinki/blob/master/vignettes/gisfin_tutorial.md">tutoriaalista</a>.</p>
<p>Tärkeimmät tällä hetkellä mukanava olevat lähteet ovat</p>
<ul>
<li><a href="http://ptp.hel.fi/avoindata/">Helsingin kaupungin Kiinteistöviraston aluejakokartat (HKK)</a></li>
<li><a href="http://www.hsy.fi/seututieto/kaupunki/paikkatiedot/Sivut/Avoindata.aspx">Helsingin seudun ympäristöpalvelun paikkatietoaineistot (HSY)</a></li>
<li><a href="http://www.maanmittauslaitos.fi/avoindata">Maanmittauslaitoksen avointa dataa</a></li>
<li><a href="http://www.stat.fi/tup/rajapintapalvelut/index_en.html">Tilastokeskuksen paikkatietoaineistoja</a></li>
</ul>
<p>Seuraavaksi aiomme laajentaa yksittäisistä kaupungeista saatavilla olevan datan määrä sisällyttämällä pakettiin <a href="http://paikkatietokeskus.lounaispaikka.fi/fi/aineistot/">Lounaispaikan</a> Turku-aineistoja. <a href="http://louhos.github.io/contact.html">Ota yhteyttä</a> jos haluat ehdottaa uusia datalähteitä!</p>
<p><code>gisfin</code>-paketti jatkaa suomalaisen avoimen datan R-ekosysteemin laajenemista. Keväällä <a href="http://louhos.github.io/news/2014/06/11/helsinki-kirjasto/">toteutimme</a> Datademon edellisen kierroksen rahoituksen turvin pääkaupunkiseudun avoimeen dataan keskittyneen <a href="https://github.com/rOpenGov/helsinki"><code>helsinki</code>-paketin</a>. Omalta osaltamme Datademo on tarjonnyt sopivia resursseja kehitystyön ylläpitämiseen ja kokemuksemme molemmista kierroksista ovat olleet erittäin positiivisia.</p>
<p><code>gisfin</code> on edelleen aktiivisen kehityksen alla ja tulevaisuudessa lisäämme <a href="https://github.com/rOpenGov/gisfin/blob/master/vignettes/todo-datasets.md">uusia datalähteitä</a> ja kehitämme käyttöesimerkkejä. Paketin kehitykseen liittyi loppumetreillä mukaan myös Jussi Jousimo Helsingin yliopistolta, joka toi mukaan Tilastokeskuksen paikkatietoaineistoja. Lisäksi meillä on Jussin johdolla työn alla <a href="https://github.com/rOpenGov/fmi"><code>fmi</code>-paketti</a> Ilmatieteen laitoksen <a href="https://ilmatieteenlaitos.fi/avoin-data">avointen datojen</a> käsittelyyn sekä yleisesti paikkatiedon verkkojakeluun tarkoitettua <a href="https://en.wikipedia.org/wiki/Web_Feature_Service">WFS</a>-rajapintamäärittelyä ymmärtävä <a href="https://github.com/rOpenGov/rwfs"><code>rwfs</code>-paketti</a>. Suomalainen avoimen datan R-ekosysteemi jatkaa siis laajenemistaan myös tulevaisuudessa!</p>
<h2 id="esimerkkejä">Esimerkkejä</h2>
<h3 id="suomen-kunnat-kartalle">Suomen kunnat kartalle</h3>
<p>Kuntarajat ovat tarpeellisia erilaisissa vaikkappa vaaleihin tai tilastotietoihin liittyvissä visualisoinneissa. Toisaalta kuntarajat muuttuvat lähes vuosittain. Ajantasainen kuntaraja-aineisto on saatavissa Maanmittauslaitokslta, mutta verrattain hankalassa GML-formaatissa. Alla oleva esimerkki näyttää, kuinka <code>list_mml_datasets</code>-funktiota voidaan käyttää listaamaan saatavilla olevat MML:n avoimet aineistot. Tämä jälkeen kuntaraja-aineisto (hallintoalueet) haetaan <code>get_mml</code>  -funktiolla.</p>
<pre><code class="language-{%" data-lang="{%">library(gisfin)

list_mml_datasets()
</code></pre><pre><code class="language-{%" data-lang="{%">## $`2012`
## character(0)
## 
## $`Maastotietokanta-tiesto1`
## [1] &quot;N61_v&quot;
## 
## $`Maastotietokanta-tiesto2`
## [1] &quot;N62_p&quot; &quot;N62_s&quot; &quot;N62_t&quot; &quot;N62_v&quot;
## 
## $`Yleiskartta-1000`
##  [1] &quot;AmpumaRaja&quot;             &quot;HallintoAlue&quot;          
##  [3] &quot;HallintoAlue_DataFrame&quot; &quot;HallintoalueRaja&quot;      
##  [5] &quot;KaasuJohto&quot;             &quot;KarttanimiPiste500&quot;    
##  [7] &quot;KarttanimiPiste1000&quot;    &quot;KorkeusAlue&quot;           
##  [9] &quot;KorkeusViiva500&quot;        &quot;KorkeusViiva1000&quot;      
## [11] &quot;LentokenttaPiste&quot;       &quot;LiikenneAlue&quot;          
## [13] &quot;MaaAlue&quot;                &quot;Maasto1Reuna&quot;          
## [15] &quot;Maasto2Alue&quot;            &quot;MetsaRaja&quot;             
## [17] &quot;PeltoAlue&quot;              &quot;RautatieViiva&quot;         
## [19] &quot;SahkoLinja&quot;             &quot;SuojaAlue&quot;             
## [21] &quot;SuojametsaRaja&quot;         &quot;SuojeluAlue&quot;           
## [23] &quot;TaajamaAlue&quot;            &quot;TaajamaPiste&quot;          
## [25] &quot;TieViiva&quot;               &quot;VesiAlue&quot;              
## [27] &quot;VesiViiva&quot;             
## 
## $`Yleiskartta-4500`
##  [1] &quot;HallintoAlue&quot;        &quot;HallintoalueRaja&quot;    &quot;KarttanimiPiste2000&quot;
##  [4] &quot;KarttanimiPiste4500&quot; &quot;KarttanimiPiste8000&quot; &quot;KorkeusAlue&quot;        
##  [7] &quot;KorkeusViiva&quot;        &quot;Maasto1Reuna&quot;        &quot;RautatieViiva&quot;      
## [10] &quot;TaajamaPiste2000&quot;    &quot;TaajamaPiste4500&quot;    &quot;TaajamaPiste8000&quot;   
## [13] &quot;TieViiva2000&quot;        &quot;TieViiva4500&quot;        &quot;TieViiva8000&quot;       
## [16] &quot;VesiAlue&quot;            &quot;VesiViiva2000&quot;       &quot;VesiViiva4500&quot;      
## [19] &quot;VesiViiva8000&quot;
</code></pre><pre><code class="language-{%" data-lang="{%"># Haetaan hallinto-alue aineisto
sp.mml &lt;- get_mml(map.id=&quot;Yleiskartta-4500&quot;, data.id=&quot;HallintoAlue&quot;)

# Luodaan sopiva temaattinen karttaväritys aineistolle
sp.mml@data$COL &lt;- factor(generate_map_colours(sp.mml))
# Piirretään kartta-aineisto käyttäen kuntia
spplot(sp.mml, zcol=&quot;COL&quot;, col.regions=rainbow(length(levels(sp.mml@data$COL))), colorkey=FALSE)
</code></pre><p><img src="/post/2014-08-24-gisfin-kirjasto.fi_files/MML_kunnat-1.png" alt="center"></p>
<h3 id="helsingin-äänestysalueet">Helsingin äänestysalueet</h3>
<p>Maamme suuremmat kaupungit kuten Helsinki, Turku ja Tampere tarjoavat monenlaisia avoimia aineistoja, joista osa on myös paikkaan sidottuja. Helsingissä paikkatietoaineistoja on saatavilla esimerkiksi <a href="http://ptp.hel.fi/">Helsingin kaupungin paikkatietopalveluiden</a> kautta. Seuraava esimerkki noutaa kaupungin sivuilta pääkaupunkiseudun äänestysalueet ja visualisoi kartan kunnittain.</p>
<pre><code class="language-{%" data-lang="{%">sp.aanestys &lt;- get_helsinki_aluejakokartat(map.specifier=&quot;aanestysalue&quot;)
spplot(sp.aanestys, zcol=&quot;KUNTA&quot;, col.regions=rainbow(length(levels(sp.aanestys@data$KUNTA))), colorkey=FALSE)
</code></pre><p><img src="/post/2014-08-24-gisfin-kirjasto.fi_files/hkk-aanestysalue-1.png" alt="center"></p>
<p>Seuraava esimerkki puolestaan näyttää, kuinka Helsingin peruspiirijako voidaan piirtää Googlen karttapalvelusta saadun taustakartan päälle. Haetaan ensin aineisto:</p>
<pre><code class="language-{%" data-lang="{%">library(ggmap)
</code></pre><pre><code class="language-{%" data-lang="{%">## Error in library(ggmap): there is no package called 'ggmap'
</code></pre><pre><code class="language-{%" data-lang="{%">library(ggplot2)

sp.piiri &lt;- get_helsinki_spatial(map.type=&quot;piirijako&quot;, map.specifier=&quot;ALUEJAKO_PERUSPIIRI&quot;)
</code></pre><p>Googlen kartta-aineistot ovat maantieteellisessä,
<a href="https://fi.wikipedia.org/wiki/WGS84">WGS84</a>-pohjaisessa
koordinaattijärjestelmässä. Peruspiirien piirtämistä varten selvitetään ensin
missä koordinaattijärjestelmässä peruspiiriaineisto on:</p>
<pre><code class="language-{%" data-lang="{%">sp.piiri@proj4string
</code></pre><pre><code class="language-{%" data-lang="{%">## CRS arguments:
##  +init=epsg:3879 +proj=tmerc +lat_0=0 +lon_0=25 +k=1 +x_0=25500000
## +y_0=0 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs
</code></pre><p><a href="http://www.epsg-registry.org/">EPSG</a>-koodi 3879 paljastaa, että aineisto on
Helsingissä käytössä olevassa ETRS89/GK25FIN tasokoordinaattijärjestelmässä.
Aineiston saamiseksi yhteismitalliseksi Googlen taustakartan kanssa, on se ensin
projisoitava maantieteelliseen koordinaattijärjestelmään:</p>
<pre><code class="language-{%" data-lang="{%">sp.piiri &lt;- sp::spTransform(sp.piiri, CRS(&quot;+proj=longlat +datum=WGS84&quot;))
</code></pre><p>Lopuksi piirretään peruspiirit ja taustakartta käyttäen suosittua
<code>ggplot2</code>-pakettia ja sen karttalaajennosta, <code>ggmap</code>-pakettia:</p>
<pre><code class="language-{%" data-lang="{%"># Syötetään keskikoordinaatit peruspiirien maaantieteelliselle ulottuvuudelle
hel.center &lt;- apply(bbox(sp.piiri), 1, mean)

# Haetaan kartta Googlen karttapalvelusta
hel.map &lt;- ggmap::get_map(location=hel.center, source=&quot;google&quot;, zoom=10, scale=2)
</code></pre><pre><code class="language-{%" data-lang="{%">## Error in loadNamespace(name): there is no package called 'ggmap'
</code></pre><pre><code class="language-{%" data-lang="{%"># Muokataan paikkatietoaineisto ggplot2:lle sopivaan muotoon ja piirretään
# aineistot
df.piiri &lt;- sp2df(sp.piiri, region=&quot;NIMI&quot;)
ggmap(hel.map) + geom_polygon(data=df.piiri, aes(x=long, y=lat, fill=NIMI), alpha=0.5) + theme(legend.position=&quot;none&quot;)
</code></pre><pre><code class="language-{%" data-lang="{%">## Error in eval(expr, envir, enclos): could not find function &quot;ggmap&quot;
</code></pre><!-- raw HTML omitted -->


    

    


</article>



        </div>

        

      </div>
    </div>
    

    
      <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML"> </script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({ tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]} })
</script>
    

    
    
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
  </body>
</html>
